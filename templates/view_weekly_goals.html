<!DOCTYPE html>
<html>
<head>
<title>Weekly Goals</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body{background:#f3f4f6;}

.top-bar{
display:flex;
justify-content:space-between;
align-items:center;
margin-bottom:20px;
}

.page-title{color:#15803d;font-weight:700;}

.list-header{
display:flex;
justify-content:space-between;
padding:10px 20px;
background:#dcfce7;
border-radius:10px;
font-weight:700;
color:#065f46;
margin-bottom:10px;
}

.goal-card{
background:white;
padding:15px 20px;
border-radius:14px;
margin-bottom:12px;
display:flex;
justify-content:space-between;
align-items:center;
box-shadow:0 4px 12px rgba(0,0,0,.08);
}

.modal-content{border-radius:16px;}
textarea{margin-bottom:8px;border-radius:10px;}
</style>
</head>

<body>

<div class="container mt-4">

<div class="top-bar">

<h3 class="page-title">Your Weekly Goals</h3>

<div>
<a href="/" class="btn btn-secondary shadow rounded-pill px-4">⬅ Dashboard</a>

<button class="btn btn-success"
data-bs-toggle="modal"
data-bs-target="#weeklyModal">
➕ Add Weekly Goal
</button>
</div>

</div>

<div class="list-header">
<span>Goal</span>
<span>Action</span>
</div>

{% for g in goals %}

<div class="goal-card">

<span>{{g.WeeklyGoal}}</span>

<div>

<button class="btn btn-info btn-sm"
data-bs-toggle="modal"
data-bs-target="#read{{g.row}}">
Read
</button>

{% if session['role']=="Teacher" %}

<button class="btn btn-warning btn-sm"
data-bs-toggle="modal"
data-bs-target="#update{{g.row}}">
Update
</button>

<a href="/delete_weekly/{{g.row}}"
onclick="return confirm('Delete this goal?')"
class="btn btn-danger btn-sm">
Delete
</a>

{% endif %}
</div>


</div>

<!-- READ -->
<div class="modal fade" id="read{{g.row}}">
<div class="modal-dialog modal-dialog-centered">
<div class="modal-content p-3">

<div class="modal-header">
<h5>Weekly Goal Details</h5>
<button class="btn-close" data-bs-dismiss="modal"></button>
</div>

<p><b>Goal:</b> {{g.WeeklyGoal}}</p>
<p><b>Reflection:</b> {{g.Reflection}}</p>
<p><b>Went Well:</b> {{g.WentWell}}</p>
<p><b>Challenges:</b> {{g.Challenges}}</p>
<p><b>Left:</b> {{g.Left}}</p>
<p><b>Status:</b> {{g.Status}}</p>

</div>
</div>
</div>

<!-- UPDATE -->
<div class="modal fade" id="update{{g.row}}">
<div class="modal-dialog modal-lg modal-dialog-centered">
<div class="modal-content p-3">

<form action="/save_update_weekly/{{g.row}}" method="POST">

<div class="modal-header">
<h5>Update Weekly Goal</h5>
<button class="btn-close" data-bs-dismiss="modal"></button>
</div>

<div class="modal-body">

<textarea name="goal" class="form-control">{{g.WeeklyGoal}}</textarea>
<textarea name="reflection" class="form-control">{{g.Reflection}}</textarea>
<textarea name="wentwell" class="form-control">{{g.WentWell}}</textarea>
<textarea name="challenges" class="form-control">{{g.Challenges}}</textarea>
<textarea name="left" class="form-control">{{g.Left}}</textarea>

<select name="status" class="form-control mb-2">
<option value="In Progress" {% if g.Status=="In Progress" %}selected{% endif %}>In Progress</option>
<option value="Completed" {% if g.Status=="Completed" %}selected{% endif %}>Completed</option>
</select>

</div>

<div class="modal-footer">
<button class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
<button class="btn btn-success">Save</button>
</div>

</form>

</div>
</div>
</div>

{% endfor %}

</div>

<!-- ADD WEEKLY -->

<div class="modal fade" id="weeklyModal">
<div class="modal-dialog modal-dialog-centered">
<div class="modal-content p-4">
<div class="modal-header">
<h4>New Weekly Goal</h4>
<button class="btn-close" data-bs-dismiss="modal"></button>
</div>
<!-- <h4>New  Goal</h4> -->
<p class="text-muted">Set a goal to accomplish this week.</p>

<form action="/save_weekly" method="POST">

<label>What do you want to achieve?</label>
<textarea name="goal" class="form-control mb-3"
placeholder="e.g., Complete 5 React exercises" required></textarea>

<label>Select Week</label>
<input type="date" name="week" class="form-control mb-4" required>

<div class="d-flex justify-content-end gap-2">
<button type="button" class="btn btn-light" data-bs-dismiss="modal">Cancel</button>
<button class="btn btn-primary px-4">Add Goal</button>
</div>

</form>

</div>
</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
